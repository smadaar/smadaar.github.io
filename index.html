<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Simple Consistent Hashing</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: auto; }
    textarea, input { width: 100%; margin-bottom: 10px; padding: 8px; font-size: 14px; }
    button { padding: 10px 20px; font-size: 16px; }
    #result { font-size: 18px; font-weight: bold; margin-top: 10px; }
  </style>
</head>
<body>
  <h2>Hash Choo3333ser</h2>

  <label>List of Values (one per line):</label>
  <textarea id="values" rows="6" placeholder="nodeA&#10;nodeB&#10;nodeC"></textarea>

  <label>Single Value:</label>
  <input type="text" id="singleValue" placeholder="e.g. nodeB" />

  <label>Salt:</label>
  <input type="text" id="salt" placeholder="Optional salt" />

  <button onclick="runHashMatch()">Check</button>

  <div id="result"></div>

  <script>
    async function sha1Hex(str) {
      const buffer = new TextEncoder().encode(str);
      const hash = await crypto.subtle.digest("SHA-1", buffer);
      const byteArray = new Uint8Array(hash);
      // Convert to integer (first 4 bytes only for simplicity)
      return (
        (byteArray[0] << 24) |
        (byteArray[1] << 16) |
        (byteArray[2] << 8) |
        (byteArray[3])
      ) >>> 0; // unsigned
    }

    async function runHashMatch() {
      const values = document.getElementById("values").value
        .split("\n")
        .map(v => v.trim())
        .filter(v => v);
      const singleValue = document.getElementById("singleValue").value.trim();
      const salt = document.getElementById("salt").value.trim();

      if (!values.length || !singleValue) {
        document.getElementById("result").innerText = "Please enter both the list and single value.";
        return;
      }

      const hashInput = salt + singleValue;
      const hash = await sha1Hex(hashInput);
      const index = hash % values.length;
      const chosenValue = values[index];
      const match = (chosenValue === singleValue);

      document.getElementById("result").innerText =
        `Chosen: ${chosenValue}\nMatch: ${match ? "✅ True" : "❌ False"}`;
    }
  </script>
</body>
</html>
